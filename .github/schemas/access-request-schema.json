{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "array",
  "items": {
    "type": "object",
    "required": [
      "request_id",
      "business_justification",
      "source",
      "destination",
      "protocol",
      "port"
    ],
    "properties": {
      "request_id": { "type": ["string", "number"] },
      "business_justification": { "type": "string" },
      "source": {
        "type": "object",
        "properties": {
          "account_id": { "type": ["number", "null"] },
          "vpc_id": {
            "type": ["string", "null"],
            "pattern": "^vpc-[a-f0-9]{17}$"
          },
          "region": { "type": ["string", "null"] },
          "security_group_ids": {
            "type": ["array", "null"],
            "items": { "type": "string" },
            "default": []
          },
          "ips": {
            "type": ["array", "null"],
            "items": { "type": "string" },
            "default": []
          }
        },
        "additionalProperties": false
      },
      "destination": {
        "type": "object",
        "properties": {
          "account_id": { "type": ["number", "null"] },
          "vpc_id": {
            "type": ["string", "null"],
            "pattern": "^vpc-[a-f0-9]{17}$"
          },
          "region": {
            "type": ["string", "null"],
            "enum": ["us-west-2", "us-east-1", null]
          },
          "security_group_ids": {
            "type": ["array", "null"],
            "items": { "type": "string" },
            "default": []
          },
          "ips": {
            "type": ["array", "null"],
            "items": { "type": "string" },
            "default": []
          }
        },
        "additionalProperties": false
      },
      "protocol": { "type": "string" },
      "port": { "type": ["string", "integer"] },
      "appid": { "type": "string" },
      "url": { "type": ["string", "null"] },
      "url_category": { "type": ["string", "null"] },
      "host": { "type": ["string", "null"] },
      "thirdPartyID": { "type": ["number", "null"] },
      "thirdPartyName": { "type": ["string", "null"] },
      "enable_palo_inspection": { "type": ["boolean", "null"] },
      "region": {
        "type": ["string", "null"],
        "enum": ["us-west-2", "us-east-1", null]
      }
    },
    "additionalProperties": false
  }
}
